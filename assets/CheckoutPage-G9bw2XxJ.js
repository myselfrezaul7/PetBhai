import{g as w,c as C,f as F,d as S,r as o,j as e,G as D}from"./index-D528q6zf.js";import{s as I}from"./authService-Dkbuwon_.js";const T=()=>{const{cartItems:n,cartTotal:g,clearCart:j}=w(),{isAuthenticated:c,currentUser:s,socialLogin:N,addOrderToHistory:k}=C(),x=F(),m=S(),[l,u]=o.useState({name:"",phone:"",address:"",email:""}),[r,h]=o.useState("cod"),[p,f]=o.useState(!1);o.useEffect(()=>{n.length===0&&x("/shop")},[n,x]),o.useEffect(()=>{s&&u(a=>({...a,name:s.name||a.name,email:s.email||a.email}))},[s]);const d=a=>{const{id:t,value:i}=a.target;u(b=>({...b,[t]:i}))},y=async a=>{a.preventDefault();try{const t={items:n,total:g,userId:s==null?void 0:s.id,shippingDetails:l},i=await fetch("http://localhost:5000/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw new Error("Failed to place order");const b=await i.json();c&&k(b),m.success("Thank you for your order! It has been placed successfully."),j(),x("/")}catch(t){console.error("Order placement error:",t),m.error("Failed to place order. Please try again.")}},v=async()=>{f(!0);try{const a=await I();await N(a)}catch(a){const t=a instanceof Error?a.message:"An unknown error occurred.";console.error("Google Sign-In failed",a),m.error(`Failed to sign in with Google: ${t}`)}finally{f(!1)}};return e.jsxs("div",{className:"container mx-auto px-4 py-12 animate-fade-in",children:[e.jsx("h1",{className:"text-4xl font-bold text-center text-slate-800 dark:text-white mb-10",children:"Checkout"}),e.jsxs("div",{className:"flex flex-col-reverse lg:flex-row gap-12 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"glass-card p-8 lg:w-[58%]",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-2",children:c?"Confirm Shipping Details":"Guest Checkout"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"We'll use this information for delivery."}),!c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 mb-6",children:e.jsxs("button",{onClick:v,disabled:p,className:"w-full flex items-center justify-center space-x-3 py-3 px-4 border border-slate-300 dark:border-slate-500 rounded-lg hover:bg-slate-50/50 dark:hover:bg-slate-700/50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:[e.jsx(D,{className:"w-6 h-6"}),e.jsx("span",{className:"font-semibold text-slate-700 dark:text-slate-200",children:p?"Continuing...":"Continue with Google"})]})}),e.jsxs("div",{className:"flex items-center my-6",children:[e.jsx("div",{className:"flex-grow border-t border-slate-300 dark:border-slate-600"}),e.jsx("span",{className:"flex-shrink mx-4 text-slate-500 dark:text-slate-400 font-semibold",children:"OR"}),e.jsx("div",{className:"flex-grow border-t border-slate-300 dark:border-slate-600"})]})]}),e.jsxs("form",{onSubmit:y,className:"space-y-5",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Contact & Shipping"}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-base font-semibold text-slate-700 dark:text-slate-200 mb-2",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",value:l.name,onChange:d,required:!0,className:"w-full p-3 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white/50 dark:bg-slate-700/50"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"phone",className:"block text-base font-semibold text-slate-700 dark:text-slate-200 mb-2",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",id:"phone",value:l.phone,onChange:d,pattern:"(\\+8801|01)[3-9]\\d{8}",placeholder:"+8801...",required:!0,className:"w-full p-3 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white/50 dark:bg-slate-700/50"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"address",className:"block text-base font-semibold text-slate-700 dark:text-slate-200 mb-2",children:["Full Delivery Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"address",rows:3,value:l.address,onChange:d,required:!0,placeholder:"e.g. House No, Road No, Area, District",className:"w-full p-3 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white/50 dark:bg-slate-700/50"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-base font-semibold text-slate-700 dark:text-slate-200 mb-2",children:["Email Address"," ",e.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400 font-normal",children:"(For order confirmation)"})]}),e.jsx("input",{type:"email",id:"email",value:l.email,onChange:d,className:"w-full p-3 border border-slate-300 dark:border-slate-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white/50 dark:bg-slate-700/50"})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-4",children:"Payment Method"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:`flex items-center p-4 border rounded-lg cursor-pointer transition-all ${r==="cod"?"border-orange-500 ring-2 ring-orange-500":"border-slate-300 dark:border-slate-600"}`,children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"cod",checked:r==="cod",onChange:a=>h(a.target.value),className:"h-5 w-5 text-orange-600 focus:ring-orange-500"}),e.jsx("span",{className:"ml-3 font-semibold text-slate-700 dark:text-slate-200",children:"Cash on Delivery"})]}),e.jsxs("label",{className:`flex items-center p-4 border rounded-lg cursor-not-allowed transition-all opacity-50 ${r==="card"?"border-orange-500 ring-2 ring-orange-500":"border-slate-300 dark:border-slate-600"}`,children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"card",disabled:!0,checked:r==="card",onChange:a=>h(a.target.value),className:"h-5 w-5 text-orange-600 focus:ring-orange-500"}),e.jsxs("span",{className:"ml-3 font-semibold text-slate-700 dark:text-slate-200",children:["Card ",e.jsx("span",{className:"text-sm text-slate-500",children:"(Unavailable)"})]})]}),e.jsxs("label",{className:`flex items-center p-4 border rounded-lg cursor-not-allowed transition-all opacity-50 ${r==="mobile"?"border-orange-500 ring-2 ring-orange-500":"border-slate-300 dark:border-slate-600"}`,children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"mobile",disabled:!0,checked:r==="mobile",onChange:a=>h(a.target.value),className:"h-5 w-5 text-orange-600 focus:ring-orange-500"}),e.jsxs("span",{className:"ml-3 font-semibold text-slate-700 dark:text-slate-200",children:["Mobile Banking ",e.jsx("span",{className:"text-sm text-slate-500",children:"(Unavailable)"})]})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-300/50 dark:border-slate-600/50",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-600 dark:text-slate-300 mb-3",children:"We Accept"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("img",{src:"https://i.ibb.co/27wH07C/bkash.png",alt:"bKash",className:"h-6 grayscale hover:grayscale-0 transition-all duration-300",title:"bKash"}),e.jsx("img",{src:"https://i.ibb.co/qjqBcf5/nagad.png",alt:"Nagad",className:"h-6 grayscale hover:grayscale-0 transition-all duration-300",title:"Nagad"}),e.jsx("img",{src:"https://i.ibb.co/p3y5M3D/bank.png",alt:"Bank",className:"h-6 grayscale hover:grayscale-0 transition-all duration-300",title:"Bank Transfer"})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",className:"w-full bg-orange-500 text-white font-bold py-3 px-4 rounded-lg text-lg hover:bg-orange-600 transition-colors",children:"Place Order"})})]})]}),e.jsxs("div",{className:"glass-card p-8 h-fit lg:w-[42%]",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-6",children:"Order Summary"}),e.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto pr-2",children:n.map(a=>e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("img",{src:a.imageUrl,alt:a.name,className:"w-16 h-16 rounded-md object-cover flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-800 dark:text-white",children:a.name}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Quantity: ",a.quantity]})]})]}),e.jsxs("p",{className:"font-semibold text-slate-700 dark:text-slate-200 text-right shrink-0 ml-4",children:["৳",(a.price*a.quantity).toFixed(2)]})]},a.id))}),e.jsx("div",{className:"border-t border-slate-300/50 dark:border-slate-600/50 mt-6 pt-4",children:e.jsxs("div",{className:"flex justify-between items-center text-xl font-bold",children:[e.jsx("span",{className:"text-slate-800 dark:text-white",children:"Total:"}),e.jsxs("span",{className:"text-slate-800 dark:text-white",children:["৳",g.toFixed(2)]})]})})]})]})]})};export{T as default};
